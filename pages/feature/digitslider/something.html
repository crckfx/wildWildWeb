<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Numbin — drag no-scroll + wheel</title>
<style>
	html,
	body {
		margin: 0;
		height: 200vh;
		/* tall page to reveal unwanted scroll */
		overscroll-behavior: contain;
		background: #111;
		color: #eee;
		font: 16px/1.4 system-ui, sans-serif;
	}

	.wrap {
		margin: 3rem;
	}

	/* Gesture owner. touch-action:none is necessary but not always sufficient. */
	.numbin-wrap {
		position: relative;
		display: inline-flex;
		align-items: center;
		gap: .75rem;
		padding: 1rem;
		border-radius: 12px;
		background: #2b2b2b;
		user-select: none;
		touch-action: none;
		/* disable UA pan/zoom on this element */
	}

	/* The real input holds the value but is inert to pointer gestures. */
	.numbin {
		pointer-events: none;
		/* gestures never start on the input */
		-moz-appearance: textfield;
		appearance: textfield;
		width: 7ch;
		text-align: center;
		font-size: 2rem;
		border: none;
		border-radius: 10px;
		background: #4a4a4a;
		color: #fff;
		padding: .3rem .6rem;
		outline: none;
	}

	.numbin::-webkit-outer-spin-button,
	.numbin::-webkit-inner-spin-button {
		-webkit-appearance: none;
		margin: 0;
	}

	.hint {
		opacity: .7;
		font-size: .9rem;
	}
</style>

<div class="wrap">
	<h2>Drag or wheel over the control — page must not scroll</h2>

	<div class="numbin-wrap" id="nb1">
		<input type="number" class="numbin" value="420" min="0" max="9999" step="1" />
		<span class="hint">0–9999</span>
	</div>
</div>

<script>
	class Numbin {
		constructor(wrap, {
			min = 0,
			max = 9999,
			step = 1,
			loop = false
		} = {}) {
			this.wrap = wrap;
			this.input = wrap.querySelector('.numbin');
			this.min = +this.input.min || min;
			this.max = +this.input.max || max;
			this.step = +this.input.step || step;
			this.loop = loop || this.input.dataset.loop === 'true';
			this._y0 = 0;
			this._moved = false;

			this._bind();
		}

		get value() {
			return parseInt(this.input.value, 10) || 0;
		}
		set value(v) {
			let n = v;
			if (this.loop) {
				const r = this.max - this.min + 1;
				if (r > 0) n = ((n - this.min) % r + r) % r + this.min;
			} else {
				n = Math.max(this.min, Math.min(this.max, v));
			}
			if (String(n) !== this.input.value) {
				this.input.value = n;
				this.input.dispatchEvent(new Event('input', {
					bubbles: true
				}));
			}
		}

		_bind() {
			const el = this.wrap;
			el.addEventListener('pointerdown', e => {
				e.preventDefault();
				this._moved = false;
				this._y0 = e.clientY;
				el.setPointerCapture(e.pointerId);
			});

			el.addEventListener('pointermove', e => {
				if (!(e.buttons & 1)) return;
				e.preventDefault();
				const dy = e.clientY - this._y0;
				if (Math.abs(dy) > 10) {
					this._moved = true;
					this.value = this.value + (dy < 0 ? +this.step : -this.step);
					this._y0 = e.clientY;
				}
			});

			el.addEventListener('pointerup', e => {
				el.releasePointerCapture(e.pointerId);
				// Click → focus for typing, without page jump
				if (!this._moved) {
					this.input.focus({
						preventScroll: true
					});
					this.input.select?.();
				}
			});

			// Wheel works unfocused and never scrolls the page
			el.addEventListener('wheel', e => {
				e.preventDefault();
				// e.stopPropagation();
				const dir = Math.sign(e.deltaY);
				if (dir) this.value = this.value - dir * this.step;
			}, {
				passive: false
			});
		}
	}

	// init
	new Numbin(document.getElementById('nb1'));
</script>

</html>