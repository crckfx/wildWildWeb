<div id="applet_svg2png" class="applet full" data-orientation="">

	<!-- viewport -->
	<div id="preview">
		<canvas id="svgPreview"></canvas>
	</div>

	<div class="splitter"></div>

	<div id="textView">
		<div class="head">
			<span class="name">put a filename here</span>
			<span class="exit">x</span>
		</div>
		<div class="textBox" contenteditable="true">
			feed me some code
		</div>
		<div class="submitBar">
			<button id="submitTextView">Apply</button>
		</div>
	</div>

	<!-- controls -->
	<div class="panel-container">
		<div class="controls">
			<!-- www -->
			<div class="toolt-container" data-toolt-root="#applet_svg2png">
				<button class="toolt-btn">
					<img id="someLachiePicture" src="/favicon.ico">
				</button>
				<div class="toolt-floater">
					<div class="toolt-content">
						<a class="toolt-item" href="/">back to wildWildWeb</a>

						<form class="color-picker">
							<fieldset>
								<label>select theme</label>
								<select name="theme" id="theme" aria-label="Select Theme">
									<option value="system">üíª System</option>
									<option value="light">‚òÄÔ∏è Light</option>
									<option value="dark">üåë Dark</option>
									<option value="gen">üé® Generative</option>
								</select>
							</fieldset>
							<!-- unhidden for "gen" theme -->
							<div id="genColorPicker">
								<label>gen colour</label>
								<!-- <button>save</button> -->
								<div class="numbin" data-value="0" data-min="0" data-max="359" data-step="1" data-loop="true"></div>
								<!-- <button>more</button> -->
							</div>
						</form>
					</div>
				</div>
			</div>
			<!-- upload -->
			<div class="toolt-container" data-toolt-root="#applet_svg2png">
				<button id="uploder" class="toolt-btn ploder">
					<svg fill="none" class="icon" stroke="currentColor" stroke-width="2">
						<use href="#icon-paperclip"></use>
					</svg>
				</button>
				<div class="toolt-floater">
					<div class="toolt-content vertical">
                        <label>Upload</label>
                        <div class="group">
                            <button id="urlInput" class="toolt-item">URL...</button>
                            <button id="attachmentInput" class="toolt-item ploder">File...</button>
                        </div>
					</div>
				</div>
			</div>

			<!-- edit -->
			<button class="toolt-btn" id="toggle_showTextView">Edit</button>

			<!-- canvas -->
			<div class="toolt-container" data-toolt-root="#applet_svg2png">
				<button class="toolt-btn">
					<svg fill="none" class="icon" stroke="currentColor">
						<use href="#icon-resize"></use>
					</svg>
					<label>Canvas</label>
				</button>
				<div class="toolt-floater">
					<div class="toolt-content vertical">
						<label>Size</label>
						<div class="group">
							<div id="_renderWidth" class="numbin toolt-item" data-value="512" data-min="1" data-max="9999" data-step="1" data-loop="false">
								<input type="number">
							</div>
							<button class="bulbtn toolt-item">
								<input id="toggle_sizeLock" type="checkbox" checked />
								<label>LOCK</label>
							</button>
							<div id="_renderHeight" class="numbin toolt-item" data-value="512" data-min="1" data-max="9999" data-step="1" data-loop="false">
								<input type="number">
							</div>
						</div>
						<label>Background</label>
						<div class="group">
							<button class="bulbtn toolt-item">
								<input id="bgToggle" type="checkbox">
								<label for="bgToggle" style="font-size: 14px;">background on/off</label>
							</button>
							<span>
								<label for="bgColorInput">colour</label>
								<input id="bgColorInput" type="color" value="#ffffff">
							</span>
						</div>
					</div>
				</div>
			</div>
			<!-- preview -->
			<div class="toolt-container" data-toolt-root="#applet_svg2png">
				<button class="toolt-btn">
					<svg fill="none" class="icon" stroke="currentColor">
						<use href="#icon-view-settings"></use>
					</svg>
					<label>Preview</label>
				</button>
				<div class="toolt-floater">
					<div class="toolt-content">
						<button class="bulbtn toolt-item">
							<input id="toggle_fitToPage" type="checkbox">
							<label for="toggle_fitToPage">fit preview</label>
						</button>
						<button class="bulbtn toolt-item">
							<input id="toggle_showOutline" type="checkbox" checked>
							<label for="toggle_showOutline">show outline</label>

						</button>
					</div>
				</div>
			</div>
			<!-- export -->
			<div class="toolt-container" data-toolt-root="#applet_svg2png">
				<button class="toolt-btn">
					<svg class="icon">
						<use href="#icon-export"></use>
					</svg>
				</button>
				<div class="toolt-floater">
					<div class="toolt-content">
						<button class="toolt-item">SVG...</button>
						<button class="toolt-item">PNG...</button>
					</div>
				</div>
			</div>
		</div>
	</div>



	<dialog id="urlDialog">
		<form method="dialog" id="urlForm">
			<label for="urlField">Paste SVG URL:</label>
			<input type="url" id="urlField" name="url" required placeholder="https://example.com/file.svg" />
		</form>
	</dialog>

</div>

<script src="/misc/toolt/toolt.js"></script>

<script type="module">
    import {Resizer} from "/misc/resizer/Resizer.js";

	const applet = document.getElementById('applet_svg2png');

	const validLayoutNames = [
		"small", "big", "full"
	];

	function switchLayout(name) {
		// remove all valid names from classList, then add the valid one
		if (!validLayoutNames.includes(name)) return; // sanity check
		validLayoutNames.forEach(layout => applet.classList.remove(layout));
		applet.classList.add(name);
	}

	const w = window.innerWidth;
	const h = window.innerHeight;
	const aspect = w / h;

	let landscape = false;
	let mobile = false;
	if (w < 700 || h < 600) mobile = true;
	if (aspect > 1.2) landscape = true;


	console.log(`w: ${w}`);
	console.log(`h: ${h}`);
	console.log(`aspect-ratio: ${aspect}`);
	console.log(`mobile: ${mobile}`);
	console.log(`orientation: ${landscape ? "landscape" : "portrait"}`);

	applet.dataset.orientation = landscape ? "landscape" : "portrait";

	const someApplet = document.querySelector(".applet");
	let resizeTimer;

	function handleResize() {
		const {
			innerWidth: w,
			innerHeight: h
		} = window;
		const mobile = (w < 700 || h < 600);
		const aspect = (w / h) > 1.2 ? "landscape" : "portrait";
		// const landscape = aspect;
		someApplet.setAttribute("data-orientation", aspect);
		someApplet.setAttribute("data-mobile", mobile);
		console.log(`aspect-ratio: ${aspect}, w: ${w}, h:${h}`);
	}

	if (!someApplet) {
		console.error("no applet dawg");
	} else {
		const resize = new Resizer(handleResize, 100);
        handleResize();
	}
</script>