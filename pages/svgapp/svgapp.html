<div id="applet_svg2png" class="applet full">

	<!-- viewport -->
	<div id="preview">
		<canvas id="svgPreview"></canvas>
	</div>

	<!-- controls -->
	<div class="controls">
		<div class="control">
			<div class="custom-tooltip-container">
				<button class="custom-tooltip-btn">Hover me</button>
				<div class="ct-content-container">
					<a class="custom-tooltip-content" href="https://github.com/crckfx">'crckfx' github</a>
					<a class="custom-tooltip-content" href="https://github.com/Lachoutlaws">'Lachoutlaws' github</a>
					<!-- <span class="custom-tooltip-arrow"></span> -->
				</div>
			</div>
		</div>

		<div class="control">
			<span id="svgploder" class="ploder">
				<svg fill="none" class="icon" stroke="currentColor" stroke-width="2" viewBox="0 0 48 48">
					<use href="#icon-paperclip"></use>
				</svg>
				Upload
			</span>
			<button id="urlInput">URL</button>
			<button id="toggle_showTextView">Edit</button>
			<button>Export</button>

		</div>


		<div class="control">
			<span class="numbin-container">
				<label for="renderWidth">w</label>
				<input id="renderWidth" type="number" class="numbin" value="512" min="0" max="9999" step="1" />
			</span>
			<span>
				<label for="toggle_sizeLock">lock</label>
				<input id="toggle_sizeLock" type="checkbox" checked />
			</span>
			<span class="numbin-container">
				<label for="renderHeight">h</label>
				<input id="renderHeight" type="number" class="numbin" value="512" min="0" max="9999" step="1" />
			</span>
		</div>

		<div class="control">
			<span>
				<input id="toggle_fitToPage" type="checkbox">
				<label for="toggle_fitToPage">fit preview</label>
			</span>
			<span>
				<input id="toggle_showOutline" type="checkbox" checked>
				<label for="toggle_showOutline">show outline</label>
			</span>
		</div>

		<div class="control">
			<span>
				<input id="bgToggle" type="checkbox">
				<label for="bgToggle">background on/off</label>
			</span>
			<span>
				<label for="bgColorInput">background colour</label>
				<input id="bgColorInput" type="color" value="#ffffff">
			</span>
		</div>
		<div class="control">
			<div class="custom-tooltip-container">
				<button class="custom-tooltip-btn">Hover me</button>
				<div class="ct-content-container">
					<a class="custom-tooltip-content" href="https://github.com/crckfx">'crckfx' github</a>
					<a class="custom-tooltip-content" href="https://github.com/Lachoutlaws">'Lachoutlaws' github</a>
					<!-- <span class="custom-tooltip-arrow"></span> -->
				</div>
			</div>
		</div>
	</div>


	<div id="textView">
		<div class="head">
			<span class="name">put a filename here</span>
			<span class="exit">x</span>
		</div>
		<div class="textBox" contenteditable="true">
			feed me some code
		</div>
		<div class="submitBar">
			<button id="submitTextView">Apply</button>
		</div>
	</div>

	<dialog id="urlDialog">
		<form method="dialog" id="urlForm">
			<label for="urlField">Paste SVG URL:</label>
			<input type="url" id="urlField" name="url" required placeholder="https://example.com/file.svg" />
		</form>
	</dialog>

</div>


<script>
	const applet = document.getElementById('applet_svg2png');

	const validLayoutNames = [
		"small", "big", "full"
	];

	function switchLayout(name) {
		// remove all valid names from classList, then add the valid one
		if (!validLayoutNames.includes(name)) return; // sanity check
		validLayoutNames.forEach(layout => applet.classList.remove(layout));
		applet.classList.add(name);
	}

function initFabs(root = document) {
  const margin = 8;

  function positionTooltip(host, panel) {
    const vw = document.documentElement.clientWidth;
    const hb = host.getBoundingClientRect();
    const pw = panel.offsetWidth;
    const ph = panel.offsetHeight;

    // Center horizontally in viewport space
    let left = hb.left + hb.width / 2 - pw / 2;
    if (left < margin) left = margin;
    if (left + pw > vw - margin) left = vw - pw - margin;

    // Pin bottom of tooltip to top of host
    let top = hb.top - ph;
    if (top < margin) top = hb.bottom; // flip below if offscreen

    panel.style.left = `${Math.round(left)}px`;
    panel.style.top = `${Math.round(top)}px`;
  }

  root.querySelectorAll('.custom-tooltip-container').forEach(host => {
    const panel = host.querySelector('.ct-content-container');
    if (!panel) return;

    const show = () => requestAnimationFrame(() => positionTooltip(host, panel));
    const hide = () => {}; // no reset needed; next show repositions

    host.addEventListener('mouseenter', show);
    host.addEventListener('focusin', show);
    host.addEventListener('mouseleave', hide);
    host.addEventListener('focusout', hide);
  });
}

window.addEventListener('load', () => initFabs(document));

</script>